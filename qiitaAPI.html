<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8">
  <title>Qiita API を使って記事を取得</title>
  <!-- <meta name="description" content="ディスクリプションを入力"> -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- <link rel="stylesheet" href="style.css"> -->
  <!-- <script src="main.js"></script> -->
  <script type="text/javascript">

    // 投稿の取得
    async function fetchMyQiitaPosts() {
      const TOKEN = "28688fed6e6402e99b24f44b94c1efd7fb442ea8";
      const url = "https://qiita.com/api/v2/authenticated_user/items";
      const options = {
        method: "GET",
        headers: {
          Authorization: `Bearer ${TOKEN}`,
        },
      };

      let response = await fetch(url, options);

      if (response.ok) {
        let json = await response.json();
        let postsList = document.getElementById("qiita-posts");

        for (let post of json) {
          let createdAtDate = new Date(post.created_at).toLocaleDateString();
          let updatedAtDate = new Date(post.updated_at).toLocaleDateString();
          let textNode;

          if (!post.private) {
            let listItem = document.createElement("li");
            textNode = document.createTextNode(
              `${post.title} (作成日: ${createdAtDate}, 更新日: ${updatedAtDate})`
            );
            listItem.appendChild(textNode);
            postsList.appendChild(listItem);
          }
        }
      } else {
        console.log("HTTP-Error: " + response.status);
      }
    }
    fetchMyQiitaPosts();

  </script>
</head>

<body>

  Qiita の記事一覧を表示
  <ul id="qiita-posts"></ul>

</body>

</html>